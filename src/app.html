<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/png" href="/static/HLX-black.png" crossorigin="use-credentials" />
		<link
			rel="icon"
			type="image/png"
			href="/static/HLX-black.png"
			sizes="96x96"
			crossorigin="use-credentials"
		/>
		<link rel="shortcut icon" href="/static/HLX-black.png" crossorigin="use-credentials" />
		<link
			rel="apple-touch-icon"
			sizes="180x180"
			href="/static/HLX-black.png"
			crossorigin="use-credentials"
		/>
		<link rel="manifest" href="/manifest.json" crossorigin="use-credentials" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover"
		/>
		<meta name="theme-color" content="#000000" />
		<meta name="robots" content="noindex,nofollow" />

		<!-- Anurati Font - Preload for splash screen -->
		<link rel="preload" href="/assets/fonts/Anurati.otf" as="font" type="font/otf" crossorigin>
		
		<style>
			@font-face {
				font-family: 'Anurati';
				src: url('/assets/fonts/Anurati.otf') format('opentype');
				font-weight: normal;
				font-style: normal;
				font-display: block;
			}
			
			/* Ensure splash screen text uses Anurati */
			#splash-screen .terminal-text,
			#splash-screen .terminal-line {
				font-family: 'Anurati', 'Arial Black', sans-serif !important;
			}
		</style>

		<!-- External CSS (editable without full rebuild via volume mount) -->
		<link rel="stylesheet" href="/static/splash.css" crossorigin="use-credentials" />
		<link rel="stylesheet" href="/static/custom.css" crossorigin="use-credentials" />
		<script src="/static/loader.js" defer crossorigin="use-credentials"></script>

		<script>
			function resizeIframe(obj) {
				obj.style.height = obj.contentWindow.document.documentElement.scrollHeight + 'px';
			}
		</script>

		<script>
			// On page load or when changing themes, best to add inline in `head` to avoid FOUC
			(() => {
				const metaThemeColorTag = document.querySelector('meta[name="theme-color"]');
				const prefersDarkTheme = window.matchMedia('(prefers-color-scheme: dark)').matches;

				if (!localStorage?.theme) {
					localStorage.theme = 'system';
				}

				if (localStorage.theme === 'system') {
					document.documentElement.classList.add(prefersDarkTheme ? 'dark' : 'light');
					metaThemeColorTag.setAttribute('content', prefersDarkTheme ? '#000000' : '#f5f3f7');
				} else if (localStorage.theme === 'oled-dark') {
					document.documentElement.style.setProperty('--color-gray-800', '#0a0510');
					document.documentElement.style.setProperty('--color-gray-850', '#050208');
					document.documentElement.style.setProperty('--color-gray-900', '#020103');
					document.documentElement.style.setProperty('--color-gray-950', '#000000');
					document.documentElement.classList.add('dark');
					metaThemeColorTag.setAttribute('content', '#000000');
				} else if (localStorage.theme === 'light') {
					document.documentElement.classList.add('light');
					metaThemeColorTag.setAttribute('content', '#f5f3f7');
				} else if (localStorage.theme === 'her') {
					document.documentElement.classList.add('her');
					metaThemeColorTag.setAttribute('content', '#983724');
				} else {
					document.documentElement.classList.add('dark');
					metaThemeColorTag.setAttribute('content', '#000000');
				}

				window.matchMedia('(prefers-color-scheme: dark)').addListener((e) => {
					if (localStorage.theme === 'system') {
						if (e.matches) {
							document.documentElement.classList.add('dark');
							document.documentElement.classList.remove('light');
							metaThemeColorTag.setAttribute('content', '#000000');
						} else {
							document.documentElement.classList.add('light');
							document.documentElement.classList.remove('dark');
							metaThemeColorTag.setAttribute('content', '#f5f3f7');
						}
					}
				});
			})();
		</script>

		<title>Obsidian</title>

		%sveltekit.head%
		
		<!-- Splash screen controller - Persistent animation, then fade -->
		<script>
			(function() {
				// ===== SPLASH TIMING CONFIG =====
				const ANIMATION_DURATION = 5500;  // Full animation plays (5.5 seconds for typing + pause)
				const FADE_DURATION = 800;        // Fade out duration
				// ================================
				
				// Always wait for the full animation to complete
				setTimeout(function() {
					const splash = document.getElementById('splash-screen');
					if (splash && !splash.classList.contains('hiding')) {
						splash.classList.add('hiding');
						splash.style.transition = 'opacity ' + FADE_DURATION + 'ms ease-out';
						splash.style.opacity = '0';
						setTimeout(function() {
							splash.style.display = 'none';
							splash.remove();
						}, FADE_DURATION);
					}
				}, ANIMATION_DURATION);
			})();
		</script>
	</head>

	<body data-sveltekit-preload-data="hover">
		<!-- Splash Screen - Clean terminal typing animation -->
		<div id="splash-screen">
			<div class="terminal-container">
				<div class="terminal-line">
					<span class="terminal-text">OBSIDIAN</span><span class="terminal-cursor"></span>
				</div>
			</div>
		</div>

		<div style="display: contents">%sveltekit.body%</div>
	</body>

	<style type="text/css" nonce="">
		html {
			overflow-y: hidden !important;
			overscroll-behavior-y: none;
		}
	</style>
</html>
